<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>RF – Resumo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
}

body{
  background:#0f0f0f;
  color:#fff;
  min-height:100vh;
}

/* HEADER */
.top{
  background:#ffffff;
  padding:25px 20px 55px;
  border-bottom-left-radius:40px;
  border-bottom-right-radius:40px;
}

.logo{
  font-weight:900;
  font-size:1.4rem;
  color:#000;
}

/* CONTAINER */
.content{
  width:90%;
  max-width:420px;
  margin:0 auto 120px;
}

/* CARD */
.card{
  background:#1c1c1c;
  border-radius:20px;
  padding:20px;
  margin-bottom:20px;
  box-shadow:0 12px 30px rgba(0,0,0,.5);
}

.card h3{
  font-size:.95rem;
  margin-bottom:12px;
  color:#facc15;
}

/* ROTA */
.rota-item{
  margin-bottom:6px;
  font-size:.9rem;
}

.rota-item span{
  color:#aaa;
}

/* OBS */
textarea{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid #333;
  background:#111;
  color:#fff;
  resize:none;
  min-height:90px;
  font-size:.85rem;
}

/* CATEGORIA */
.categoria{
  display:flex;
  gap:10px;
}

.cat-btn{
  flex:1;
  padding:14px;
  border-radius:14px;
  background:#111;
  border:2px solid #333;
  cursor:pointer;
  text-align:center;
  transition:.2s;
  font-size:.85rem;
}

.cat-btn.active{
  border-color:#facc15;
  background:rgba(250,204,21,.15);
}

/* DETALHAMENTO */
.linha{
  display:flex;
  justify-content:space-between;
  font-size:.85rem;
  margin-bottom:6px;
}

.linha span:first-child{
  color:#aaa;
}

.total{
  font-size:1.1rem;
  font-weight:700;
  color:#facc15;
  margin-top:10px;
}

/* FOOTER */
.footer{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:#0f0f0f;
  padding:15px 20px;
  box-shadow:0 -8px 25px rgba(0,0,0,.6);
}

.footer-content{
  max-width:420px;
  margin:0 auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.footer button{
  padding:12px 28px;
  border:none;
  border-radius:30px;
  background:#facc15;
  color:#000;
  font-weight:700;
  cursor:pointer;
}

.valor-final{
  font-size:1.4rem;
  font-weight:700;
  color:#facc15;
}
</style>
</head>
<body>

<div class="top">
  <div class="logo">RESUMO DA VIAGEM</div>
</div>

<div class="content">

  <!-- ROTA -->
  <div class="card">
    <h3>Rota</h3>
    <div id="rotaDetalhes"></div>
  </div>

  <!-- OBSERVAÇÃO -->
  <div class="card">
    <h3>Observação ao motorista</h3>
    <textarea id="obsInput" placeholder="Ex: excesso de pessoas, mala grande, referência..."></textarea>
  </div>

  <!-- CATEGORIA -->
  <div class="card">
    <h3>Categoria do Veículo</h3>
    <div class="categoria">
      <div class="cat-btn active" id="cat4">
        Driver 4 Lugares<br>
        <small>Preço normal</small>
      </div>
      <div class="cat-btn" id="cat6">
        Driver 6 Lugares<br>
        <small>+50%</small>
      </div>
    </div>
  </div>

  <!-- DETALHAMENTO -->
  <div class="card">
    <h3>Detalhamento</h3>
    <div id="detalhamento"></div>
  </div>

</div>

<div class="footer">
  <div class="footer-content">
    <div class="valor-final" id="valorFinal">R$ 0,00</div>
    <button onclick="confirmar()">Solicitar</button>
  </div>
</div>

<script>

const corrida = JSON.parse(localStorage.getItem("rf_corrida_temp"));
if(!corrida) window.location.href="home.html";

let { origem, parada, destino, desvioRota, mercado, valor } = corrida;

let categoriaMultiplicador = 1;

function montarRota(){

  const rotaDiv = document.getElementById("rotaDetalhes");
  rotaDiv.innerHTML="";

  rotaDiv.innerHTML += `<div class="rota-item"><span>Origem:</span> ${origem}</div>`;

  if(parada){
    rotaDiv.innerHTML += `<div class="rota-item"><span>Parada:</span> ${parada}</div>`;
  }

  rotaDiv.innerHTML += `<div class="rota-item"><span>Destino:</span> ${destino}</div>`;
}

function calcular(){

  let base = parseFloat(valor);

  let detalhamento = "";

  detalhamento += `<div class="linha"><span>Base</span><span>R$ ${base.toFixed(2)}</span></div>`;

  if(desvioRota){
    detalhamento += `<div class="linha"><span>Desvio simples</span><span>R$ 5,00</span></div>`;
    base += 5;
  }

  if(mercado){
    detalhamento += `<div class="linha"><span>Saída mercado</span><span>R$ 3,89</span></div>`;
    base += 3.89;
  }

  if(categoriaMultiplicador > 1){
    const acrescimo = base * 0.5;
    detalhamento += `<div class="linha"><span>Driver 6 lugares</span><span>+50%</span></div>`;
    base += acrescimo;
  }

  detalhamento += `<div class="linha total"><span>Total</span><span>R$ ${base.toFixed(2)}</span></div>`;

  document.getElementById("detalhamento").innerHTML = detalhamento;
  document.getElementById("valorFinal").innerText = "R$ "+base.toFixed(2);

  localStorage.setItem("rf_total_final", base.toFixed(2));
}

document.getElementById("cat4").onclick=()=>{
  categoriaMultiplicador=1;
  document.getElementById("cat4").classList.add("active");
  document.getElementById("cat6").classList.remove("active");
  calcular();
};

document.getElementById("cat6").onclick=()=>{
  categoriaMultiplicador=1.5;
  document.getElementById("cat6").classList.add("active");
  document.getElementById("cat4").classList.remove("active");
  calcular();
};

function confirmar(){

  const observacao = document.getElementById("obsInput").value;

  const dadosFinal = {
    origem,
    parada,
    destino,
    desvioRota,
    mercado,
    categoria: categoriaMultiplicador===1 ? "Driver 4" : "Driver 6",
    observacao,
    total: localStorage.getItem("rf_total_final")
  };

  localStorage.setItem("rf_corrida_confirmada", JSON.stringify(dadosFinal));

  window.location.href="procurando.html";
}

montarRota();
calcular();

</script>

</body>
</html>