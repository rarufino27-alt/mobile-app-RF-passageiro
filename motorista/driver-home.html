<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>RF – Painel Motorista</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;
}

body{
  background:#0f0f0f;
  color:#fff;
  min-height:100vh;
}

.top{
  background:#ffffff;
  padding:25px 20px 65px;
  border-bottom-left-radius:40px;
  border-bottom-right-radius:40px;
}

.logo{
  font-weight:900;
  font-size:1.4rem;
  color:#000;
}

.status{
  margin-top:5px;
  font-weight:700;
  color:#facc15;
}

.content{
  width:90%;
  max-width:420px;
  margin:-45px auto 120px auto;
}

.card{
  background:#1c1c1c;
  border-radius:20px;
  padding:22px;
  box-shadow:0 12px 30px rgba(0,0,0,.5);
  margin-bottom:15px;
}

.btn{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  font-weight:700;
  margin-top:10px;
  cursor:pointer;
}

.btn-online{ background:#facc15; color:#000; }
.btn-green{ background:#22c55e; color:#fff; }
.btn-red{ background:#ef4444; color:#fff; }
.btn-dark{ background:#111; color:#fff; border:1px solid #333; }

.valor{
  text-align:center;
  font-size:1.8rem;
  font-weight:800;
  color:#facc15;
  margin-bottom:8px;
}

.rota{
  text-align:center;
  font-size:.85rem;
  opacity:.8;
  margin-bottom:8px;
}

.timer{
  text-align:center;
  font-size:.75rem;
  color:#ef4444;
  margin-bottom:10px;
}

input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  margin-top:8px;
}

.hidden{ display:none; }
</style>
</head>
<body>

<audio id="audioChamada" src="../assets/sounds/notificacao.mp3" preload="auto"></audio>

<div class="top">
  <div class="logo">MOTORISTA RF</div>
  <div class="status" id="statusBadge">Offline</div>
</div>

<div class="content">

  <!-- ONLINE -->
  <div class="card">
    <button class="btn btn-online" id="btnOnline" onclick="toggleOnline()">
      Ficar Online
    </button>
  </div>

  <!-- ONLINE OPTIONS -->
  <div class="card hidden" id="onlineOptions">
    <button class="btn btn-dark" onclick="abrirManual()">+ Nova Corrida Manual</button>
    <button class="btn btn-dark" onclick="simularCorrida()">Simular Corrida Recebida</button>
  </div>

  <!-- FORM MANUAL -->
  <div class="card hidden" id="formManual">
    <input type="text" id="manualOrigem" placeholder="Origem">
    <input type="text" id="manualDestino" placeholder="Destino">
    <input type="number" id="manualValor" placeholder="Valor (R$)">
    <button class="btn btn-green" onclick="iniciarManual()">Iniciar Corrida</button>
    <button class="btn btn-dark" onclick="fecharManual()">Cancelar</button>
  </div>

  <!-- RECEBENDO -->
  <div class="card hidden" id="recebendoCard">
    <div class="valor" id="rideValor"></div>
    <div class="rota" id="rideRota"></div>
    <div class="timer" id="rideTimer"></div>
    <button class="btn btn-green" onclick="aceitarCorrida()">Aceitar</button>
    <button class="btn btn-red" onclick="recusarCorrida()">Recusar</button>
  </div>

  <!-- INDO PASSAGEIRO -->
  <div class="card hidden" id="indoCard">
    <div class="valor">Indo até passageiro</div>
    <div class="rota" id="indoRota"></div>
    <button class="btn btn-green" onclick="cheguei()">Cheguei ao local</button>
    <button class="btn btn-red" onclick="cancelarCorrida()">Cancelar Corrida</button>
  </div>

  <!-- EM ANDAMENTO -->
  <div class="card hidden" id="andamentoCard">
    <div class="valor" id="andamentoValor"></div>
    <div class="rota" id="andamentoRota"></div>
    <button class="btn btn-green" onclick="finalizarCorrida()">Finalizar Corrida</button>
  </div>

  <!-- FINALIZADA -->
  <div class="card hidden" id="finalCard">
    <div class="valor" id="finalValor"></div>
    <button class="btn btn-dark" onclick="voltarPainel()">Voltar ao Painel</button>
  </div>

</div>

<script>

let online=false;
let corridaAtual=null;
let timerInterval=null;
let tempo=20;

const audio = document.getElementById("audioChamada");

function tocarAlerta(){
  audio.currentTime=0;
  audio.loop=true;
  audio.play().catch(()=>{});
}

function pararAlerta(){
  audio.pause();
  audio.currentTime=0;
  audio.loop=false;
}

function esconderTudo(){
  document.querySelectorAll(".card").forEach(c=>c.classList.add("hidden"));
  document.querySelector(".content > .card").classList.remove("hidden");
}

function toggleOnline(){
  online=!online;
  if(online){
    document.getElementById("btnOnline").innerText="Online";
    document.getElementById("btnOnline").classList.replace("btn-online","btn-green");
    document.getElementById("statusBadge").innerText="Online";
    document.getElementById("statusBadge").style.color="#22c55e";
    document.getElementById("onlineOptions").classList.remove("hidden");
  }else{
    document.getElementById("btnOnline").innerText="Ficar Online";
    document.getElementById("btnOnline").classList.replace("btn-green","btn-online");
    document.getElementById("statusBadge").innerText="Offline";
    document.getElementById("statusBadge").style.color="#facc15";
    esconderTudo();
  }
}

function abrirManual(){
  document.getElementById("formManual").classList.remove("hidden");
}

function fecharManual(){
  document.getElementById("formManual").classList.add("hidden");
}

function iniciarManual(){
  const origem=document.getElementById("manualOrigem").value;
  const destino=document.getElementById("manualDestino").value;
  const valor=document.getElementById("manualValor").value;
  if(!origem||!destino||!valor) return alert("Preencha todos os campos.");
  corridaAtual={origem,destino,valor};
  iniciarIndo();
}

function simularCorrida(){
  if(!online) return alert("Fique online primeiro.");
  corridaAtual={origem:"Centro",destino:"Aeroporto",valor:65};
  document.getElementById("rideValor").innerText="R$ "+corridaAtual.valor;
  document.getElementById("rideRota").innerText=corridaAtual.origem+" → "+corridaAtual.destino;
  tempo=20;
  document.getElementById("rideTimer").innerText="Tempo restante: 20s";
  tocarAlerta();
  timerInterval=setInterval(()=>{
    tempo--;
    document.getElementById("rideTimer").innerText="Tempo restante: "+tempo+"s";
    if(tempo<=0){
      clearInterval(timerInterval);
      pararAlerta();
      esconderTudo();
    }
  },1000);
  document.getElementById("recebendoCard").classList.remove("hidden");
}

function aceitarCorrida(){
  clearInterval(timerInterval);
  pararAlerta();
  iniciarIndo();
}

function recusarCorrida(){
  clearInterval(timerInterval);
  pararAlerta();
  esconderTudo();
}

function iniciarIndo(){
  esconderTudo();
  document.getElementById("indoCard").classList.remove("hidden");
  document.getElementById("indoRota").innerText=corridaAtual.origem;
}

function cheguei(){
  iniciarAndamento();
}

function iniciarAndamento(){
  esconderTudo();
  document.getElementById("andamentoCard").classList.remove("hidden");
  document.getElementById("andamentoValor").innerText="R$ "+corridaAtual.valor;
  document.getElementById("andamentoRota").innerText=corridaAtual.origem+" → "+corridaAtual.destino;
}

function finalizarCorrida(){
  esconderTudo();
  document.getElementById("finalCard").classList.remove("hidden");
  document.getElementById("finalValor").innerText="Corrida Finalizada - R$ "+corridaAtual.valor;
}

function cancelarCorrida(){
  esconderTudo();
}

function voltarPainel(){
  esconderTudo();
  document.getElementById("onlineOptions").classList.remove("hidden");
}

</script>

</body>
</html>